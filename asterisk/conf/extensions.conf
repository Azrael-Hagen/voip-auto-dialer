[general]
static=yes
writeprotect=no
clearglobalvars=no

[globals]
; Variables globales
CONSOLE=Console/dsp
TRUNK=PBX ON THE CLOUD

; ==================== CONTEXTO INTERNO ====================
[internal]
; Extensiones internas (4000-4999)
exten => _4XXX,1,NoOp(Llamada interna a ${EXTEN})
exten => _4XXX,n,Dial(SIP/${EXTEN},30,tT)
exten => _4XXX,n,GotoIf(${DIALSTATUS}=NOANSWER?voicemail:hangup)
exten => _4XXX,n(voicemail),Voicemail(${EXTEN}@default,u)
exten => _4XXX,n(hangup),Hangup()

; Llamadas salientes - Marcar 9 + número
exten => _9.,1,NoOp(Llamada saliente: ${EXTEN:1})
exten => _9.,n,Set(CALLERID(num)=${CALLERID(num)})
exten => _9.,n,Dial(SIP/PBX ON THE CLOUD/${EXTEN:1},60,tT)
exten => _9.,n,Hangup()

; Llamadas de emergencia directas
exten => 911,1,NoOp(Llamada de emergencia)
exten => 911,n,Dial(SIP/PBX ON THE CLOUD/911,30)
exten => 911,n,Hangup()

; Acceso a buzón de voz
exten => *97,1,VoiceMailMain(${CALLERID(num)}@default)
exten => *97,n,Hangup()

; Estado del sistema
exten => *99,1,Answer()
exten => *99,n,Playback(system-online)
exten => *99,n,SayNumber(${EPOCH})
exten => *99,n,Hangup()

; ==================== CONTEXTO DE PROVEEDOR ====================
[from-provider]
; Llamadas entrantes del proveedor
exten => _X.,1,NoOp(Llamada entrante: ${EXTEN})
exten => _X.,n,Set(CALLERID(name)=Llamada Entrante)
exten => _X.,n,Dial(SIP/4000,30,tT)  ; Redirigir a recepción
exten => _X.,n,GotoIf(${DIALSTATUS}=NOANSWER?voicemail:hangup)
exten => _X.,n(voicemail),Voicemail(4000@default,u)
exten => _X.,n(hangup),Hangup()

; ==================== CONTEXTO DE AUTO DIALER ====================
[autodialer]
; Contexto para el sistema de marcado automático
exten => _X.,1,NoOp(Auto Dialer: ${EXTEN})
exten => _X.,n,Set(CALLERID(name)=Auto Dialer)
exten => _X.,n,Set(CALLERID(num)=+1234567890)  ; Número de salida
exten => _X.,n,Dial(SIP/PBX ON THE CLOUD/${EXTEN},45,tT)
exten => _X.,n,Hangup()

; ==================== APLICACIONES ESPECIALES ====================
[applications]
; Buzón de voz principal
exten => *97,1,VoiceMailMain(${CALLERID(num)}@default)
exten => *97,n,Hangup()

; Conferencia de prueba
exten => 8000,1,Answer()
exten => 8000,n,ConfBridge(test-conference)
exten => 8000,n,Hangup()

; Echo test
exten => 8888,1,Answer()
exten => 8888,n,Echo()
exten => 8888,n,Hangup()
